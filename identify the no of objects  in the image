# 1. Import libraries
!pip install ultralytics # Install ultralytics
from ultralytics import YOLO          # YOLOv8 model
import cv2                            # for image loading/drawing
import matplotlib.pyplot as plt       # for showing the image

# 2. Load a pre-trained YOLOv8 model
# 'yolov8n.pt' = small, fast model trained on COCO dataset (80 object types)
model = YOLO("yolov8n.pt")

# 3. Set your image path
image_path = "/content/lion.jpg"   # <-- change this to your image filename

# 4. Run object detection
results = model(image_path)[0]   # take the first (and only) result

# 5. Load the image using OpenCV
img = cv2.imread(image_path)
if img is None:
    raise ValueError("Image not found. Check the image_path!")

# OpenCV reads in BGR, convert to RGB for plotting
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

# 6. Draw bounding boxes and labels on the image
for box in results.boxes:
    # Get box coordinates (x1, y1, x2, y2)
    x1, y1, x2, y2 = box.xyxy[0].tolist()
    x1, y1, x2, y2 = int(x1), int(y1), int(x2), int(y2)

    # Get class id and confidence score
    cls_id = int(box.cls[0])
    conf = float(box.conf[0])

    # Get class name (e.g. "person", "car", "dog")
    label = model.names[cls_id]

    # Draw rectangle
    cv2.rectangle(img, (x1, y1), (x2, y2), (0, 255, 0), 2)

    # Put label text above the box
    text = f"{label} {conf:.2f}"
    cv2.putText(
        img, text,
        (x1, max(y1 - 5, 10)),
        cv2.FONT_HERSHEY_SIMPLEX,
        0.5,
        (255, 0, 0),
        2
    )

# 7. Show the final image with detections
plt.figure(figsize=(8, 6))
plt.imshow(img)
plt.axis("off")
plt.title("Detected Objects")
plt.show()
