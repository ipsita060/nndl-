# 1. Import the necessary libraries
import pandas as pd
import numpy as np
from tensorflow.keras import layers, models
from sklearn.model_selection import train_test_split

# 2. Load the dataset
data = pd.read_csv("mnist_train.csv")

# 3. Split into features and labels
X = data.drop("label", axis=1).values  # all pixel columns
y = data["label"].values               # the label column

# 4. Scale the pixel values to be between 0 and 1
X = X.astype("float32") / 255.0

# 5. Split into training and validation sets (e.g., 80% train, 20% validation)
X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)

# 6. Build a simple neural network model
model = models.Sequential([
    layers.Input(shape=(784,)),            # Input layer (28x28 pixels = 784)
    layers.Dense(128, activation="relu"),  # Hidden layer
    layers.Dense(64, activation="relu"),   # Another hidden layer
    layers.Dense(10, activation="softmax") # Output layer (10 classes for digits 0-9)
])

# 7. Compile the model
model.compile(optimizer="adam",
              loss="sparse_categorical_crossentropy",
              metrics=["accuracy"])

# 8. Train the model
model.fit(X_train, y_train,
          validation_data=(X_val, y_val),
          epochs=10,
          batch_size=128)


val_loss, val_acc = model.evaluate(X_val, y_val)
print(f"Validation accuracy: {val_acc:.4f}")
